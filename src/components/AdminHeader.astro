---
interface Props {
    PageHeader :string,
    UserName : string
}

const { PageHeader, UserName} = Astro.props;
---
<!-- Header -->
<header class="flex justify-between items-center py-4 px-6 bg-white border-b-4 border-blue-600 relative z-40">
    <div class="flex items-center">
        <button id="sidebar-toggle" class="text-gray-500 focus:outline-none md:hidden">
            <i class="fas fa-bars fa-2x"></i>
        </button>
        <h1 class="text-2xl font-semibold text-gray-800 ml-4" id="page-title">{PageHeader}</h1>
    </div>
    <div class="flex items-center space-x-4">
        <!-- Notification Dropdown -->
        <div class="relative">
            <button id="notification-toggle" class="text-gray-500 hover:text-gray-700 focus:outline-none mx-4 relative">
                <i class="fas fa-bell fa-lg"></i>
                <span class="absolute -top-1 -right-1 inline-block w-3 h-3 bg-red-500 rounded-full"></span>
            </button>

            <!-- Notification Dropdown Menu -->
            <div id="notification-dropdown"
                class="dropdown-menu absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 py-2">
                <div class="px-4 py-3 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-semibold text-gray-800">Notifications</h3>
                        <span class="text-sm text-blue-600 cursor-pointer hover:text-blue-800">Mark all as
                            read</span>
                    </div>
                </div>

                <div class="max-h-96 overflow-y-auto">
                    <!-- Notification Item 1 -->
                    <div class="notification-item px-4 py-3 border-b border-gray-100 fade-in">
                        <div class="flex items-start space-x-3">
                            <div
                                class="flex-shrink-0 w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-user-plus text-blue-600"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="text-sm font-medium text-gray-900">New user registered</p>
                                <p class="text-sm text-gray-600 truncate">John Doe just signed up for an
                                    account</p>
                                <p class="text-xs text-gray-500 mt-1">2 minutes ago</p>
                            </div>
                            <div class="flex-shrink-0">
                                <span class="w-2 h-2 bg-blue-500 rounded-full inline-block"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Notification Item 2 -->
                    <div class="notification-item px-4 py-3 border-b border-gray-100 fade-in">
                        <div class="flex items-start space-x-3">
                            <div
                                class="flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-shopping-cart text-green-600"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="text-sm font-medium text-gray-900">New order received</p>
                                <p class="text-sm text-gray-600 truncate">Order #ORD-1234 has been placed
                                </p>
                                <p class="text-xs text-gray-500 mt-1">1 hour ago</p>
                            </div>
                            <div class="flex-shrink-0">
                                <span class="w-2 h-2 bg-green-500 rounded-full inline-block"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Notification Item 3 -->
                    <div class="notification-item px-4 py-3 border-b border-gray-100 fade-in">
                        <div class="flex items-start space-x-3">
                            <div
                                class="flex-shrink-0 w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-exclamation-triangle text-yellow-600"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="text-sm font-medium text-gray-900">System Alert</p>
                                <p class="text-sm text-gray-600 truncate">High server load detected</p>
                                <p class="text-xs text-gray-500 mt-1">3 hours ago</p>
                            </div>
                            <div class="flex-shrink-0">
                                <span class="w-2 h-2 bg-yellow-500 rounded-full inline-block"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Notification Item 4 -->
                    <div class="notification-item px-4 py-3 fade-in">
                        <div class="flex items-start space-x-3">
                            <div
                                class="flex-shrink-0 w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-comment text-purple-600"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="text-sm font-medium text-gray-900">New message</p>
                                <p class="text-sm text-gray-600 truncate">You have a new contact form
                                    submission</p>
                                <p class="text-xs text-gray-500 mt-1">5 hours ago</p>
                            </div>
                            <div class="flex-shrink-0">
                                <span class="w-2 h-2 bg-gray-300 rounded-full inline-block"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="px-4 py-3 border-t border-gray-200">
                    <a href="#" class="block text-center text-sm font-medium text-blue-600 hover:text-blue-800">
                        View all notifications
                    </a>
                </div>
            </div>
        </div>

        <!-- Profile Dropdown -->
        <div class="relative">
            <button id="profile-toggle"
                class="flex items-center focus:outline-none hover:bg-gray-100 rounded-lg px-2 py-1 transition-colors">
                <img class="w-8 h-8 rounded-full"
                    src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
                    alt="User">
                <span class="ml-2 text-gray-700 font-medium">{UserName}</span>
                <i class="fas fa-chevron-down ml-1 text-gray-500 text-sm"></i>
            </button>

            <!-- Profile Dropdown Menu -->
            <div id="profile-dropdown"
                class="dropdown-menu absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 py-1">
                <!-- User Info -->
                <div class="px-4 py-3 border-b border-gray-200">
                    <p class="text-sm font-medium text-gray-900">{UserName}</p>
                    <p class="text-sm text-gray-600 truncate">john.doe@example.com</p>
                </div>

                <!-- Menu Items -->
                <a href="/profile"
                    class="profile-menu-item flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 fade-in">
                    <i class="fas fa-user mr-3 text-gray-400"></i>
                    My Profile
                </a>

                <a href="#"
                    class="profile-menu-item flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 fade-in">
                    <i class="fas fa-cog mr-3 text-gray-400"></i>
                    Settings
                </a>

                <a href="#"
                    class="profile-menu-item flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 fade-in">
                    <i class="fas fa-bell mr-3 text-gray-400"></i>
                    Notifications
                </a>

                <div class="border-t border-gray-200 my-1"></div>

                <a href="#"
                    class="profile-menu-item flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 fade-in">
                    <i class="fas fa-question-circle mr-3 text-gray-400"></i>
                    Help & Support
                </a>

                <div class="border-t border-gray-200 my-1"></div>

                <a href="#"
                    class="profile-menu-item flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 fade-in">
                    <i class="fas fa-sign-out-alt mr-3"></i>
                    Sign Out
                </a>
            </div>
        </div>
    </div>
</header>

<script is:inline>
    // Notification and Profile Menu
    const notificationToggle = document.getElementById('notification-toggle');
    const notificationDropdown = document.getElementById('notification-dropdown');
    const profileToggle = document.getElementById('profile-toggle');
    const profileDropdown = document.getElementById('profile-dropdown');

    let activeDropdown = null;

    // Toggle notification dropdown
    notificationToggle.addEventListener('click', function (e) {
        e.stopPropagation();
        const isOpen = notificationDropdown.classList.contains('open');

        // Close all dropdowns first
        closeAllDropdowns();

        if (!isOpen) {
            notificationDropdown.classList.add('open');
            activeDropdown = notificationDropdown;
        }
    });

    // Toggle profile dropdown
    profileToggle.addEventListener('click', function (e) {
        e.stopPropagation();
        const isOpen = profileDropdown.classList.contains('open');

        // Close all dropdowns first
        closeAllDropdowns();

        if (!isOpen) {
            profileDropdown.classList.add('open');
            activeDropdown = profileDropdown;
        }
    });

    // Close dropdowns when clicking outside
    document.addEventListener('click', function (e) {
        if (activeDropdown && !activeDropdown.contains(e.target) && !e.target.closest('button')) {
            closeAllDropdowns();
        }
    });

    // Close dropdowns on escape key
    document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape') {
            closeAllDropdowns();
        }
    });

    function closeAllDropdowns() {
        notificationDropdown.classList.remove('open');
        profileDropdown.classList.remove('open');
        activeDropdown = null;
    }

    // Mark notification as read
    document.querySelectorAll('.notification-item').forEach(item => {
        item.addEventListener('click', function () {
            const dot = this.querySelector('.w-2.h-2');
            if (dot) {
                dot.classList.remove('bg-blue-500', 'bg-green-500', 'bg-yellow-500');
                dot.classList.add('bg-gray-300');
            }
        });
    });

    // Mark all as read
    const markAllRead = document.querySelector('.text-blue-600.cursor-pointer');
    if (markAllRead) {
        markAllRead.addEventListener('click', function (e) {
            e.stopPropagation();
            document.querySelectorAll('.notification-item .w-2.h-2').forEach(dot => {
                dot.classList.remove('bg-blue-500', 'bg-green-500', 'bg-yellow-500');
                dot.classList.add('bg-gray-300');
            });

            // Update notification badge
            const notificationBadge = document.querySelector('.bg-red-500');
            if (notificationBadge) {
                notificationBadge.style.display = 'none';
            }
        });
    }

    // Profile menu item clicks
    document.querySelectorAll('.profile-menu-item').forEach(item => {        
        if(item.getAttribute("href") == "#") {
            item.addEventListener('click', function (e) {
                e.preventDefault();
                const text = this.textContent.trim();
                alert(`Navigating to: ${text}`);
                closeAllDropdowns();
            });
        }
    });
</script>