---
import AdminLayout from "../Layout/AdminLayout.astro";


---

<style is:inline>
    .article-table {
        border-collapse: separate;
        border-spacing: 0;
    }
    .article-table th {
        position: sticky;
        top: 0;
        background-color: #f8fafc;
        z-index: 10;
    }
    .article-table tr:hover {
        background-color: #f1f5f9;
    }
    .status-published {
        background-color: #10b981;
    }
    .status-draft {
        background-color: #f59e0b;
    }
    .status-scheduled {
        background-color: #3b82f6;
    }
    .fade-in {
        animation: fadeIn 0.3s ease-in-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
</style>
<AdminLayout PageTitle="Articles" PageHeader="Articles" UserName="Bishal Biswas">
    

    <!-- Main Content -->
    <main>
        <!-- Filters and Search -->
        <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
                <div class="flex-1">
                    <div class="relative max-w-xs">
                        <input type="text" id="search-articles" placeholder="Search articles..." class="pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                    </div>
                </div>
                <div class="flex space-x-4">
                    <div class="relative">
                        <select id="status-filter" class="appearance-none bg-white pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="all">All Statuses</option>
                            <option value="published">Published</option>
                            <option value="draft">Draft</option>
                            <option value="scheduled">Scheduled</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                    <div class="relative">
                        <select id="category-filter" class="appearance-none bg-white pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="all">All Categories</option>
                            <option value="technology">Technology</option>
                            <option value="business">Business</option>
                            <option value="health">Health</option>
                            <option value="entertainment">Entertainment</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg flex items-center">
                        <i class="fas fa-plus mr-2"></i> New Article
                    </button>
                </div>
            </div>
        </div>

        <!-- Articles Table -->
        <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="overflow-x-auto">
                <table class="min-w-full article-table">
                    <thead>
                        <tr class="text-left text-gray-500 text-sm font-medium">
                            <th class="py-3 px-6">Article Name</th>
                            <th class="py-3 px-6">Publish Date</th>
                            <th class="py-3 px-6">Category</th>
                            <th class="py-3 px-6">Status</th>
                            <th class="py-3 px-6">Preview</th>
                            <th class="py-3 px-6 text-right">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="text-gray-700 divide-y divide-gray-200" id="articles-table-body">
                        <!-- Articles will be populated here by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <!-- Pagination -->
            <div class="px-6 py-4 border-t border-gray-200 flex items-center justify-between">
                <div class="text-sm text-gray-700">
                    Showing <span id="current-items">1</span> to <span id="total-items">10</span> of <span id="total-articles">50</span> results
                </div>
                <div class="flex space-x-2">
                    <button class="px-3 py-1 rounded border border-gray-300 text-gray-600 hover:bg-gray-50" id="prev-page">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="px-3 py-1 rounded border border-blue-500 bg-blue-50 text-blue-600">1</button>
                    <button class="px-3 py-1 rounded border border-gray-300 text-gray-600 hover:bg-gray-50">2</button>
                    <button class="px-3 py-1 rounded border border-gray-300 text-gray-600 hover:bg-gray-50">3</button>
                    <button class="px-3 py-1 rounded border border-gray-300 text-gray-600 hover:bg-gray-50" id="next-page">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script is:inline>
        // Sample article data
        const articles = [
            {
                id: 1,
                title: "The Future of Artificial Intelligence",
                publishDate: "2023-06-15",
                category: "Technology",
                status: "published",
                previewLink: "#preview-1"
            },
            {
                id: 2,
                title: "How to Start a Successful Business in 2023",
                publishDate: "2023-06-10",
                category: "Business",
                status: "published",
                previewLink: "#preview-2"
            },
            {
                id: 3,
                title: "10 Healthy Habits for Busy Professionals",
                publishDate: "2023-06-18",
                category: "Health",
                status: "draft",
                previewLink: "#preview-3"
            },
            {
                id: 4,
                title: "New Marvel Movie Breaks Box Office Records",
                publishDate: "2023-06-20",
                category: "Entertainment",
                status: "scheduled",
                previewLink: "#preview-4"
            },
            {
                id: 5,
                title: "Blockchain Technology Explained",
                publishDate: "2023-06-05",
                category: "Technology",
                status: "published",
                previewLink: "#preview-5"
            },
            {
                id: 6,
                title: "Investment Strategies for Uncertain Times",
                publishDate: "2023-06-12",
                category: "Business",
                status: "draft",
                previewLink: "#preview-6"
            },
            {
                id: 7,
                title: "Meditation Techniques for Stress Relief",
                publishDate: "2023-06-22",
                category: "Health",
                status: "scheduled",
                previewLink: "#preview-7"
            },
            {
                id: 8,
                title: "Upcoming Music Festivals in 2023",
                publishDate: "2023-06-08",
                category: "Entertainment",
                status: "published",
                previewLink: "#preview-8"
            },
            {
                id: 9,
                title: "The Impact of 5G on Mobile Technology",
                publishDate: "2023-06-14",
                category: "Technology",
                status: "published",
                previewLink: "#preview-9"
            },
            {
                id: 10,
                title: "Remote Work Best Practices",
                publishDate: "2023-06-19",
                category: "Business",
                status: "draft",
                previewLink: "#preview-10"
            }
        ];

        // Format date to readable format
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }

        // Render articles table
        function renderArticles(articlesToRender) {
            const tableBody = document.getElementById('articles-table-body');
            tableBody.innerHTML = '';
            
            articlesToRender.forEach(article => {
                const row = document.createElement('tr');
                row.className = 'fade-in';
                
                // Status badge class
                let statusClass = '';
                let statusText = '';
                
                switch(article.status) {
                    case 'published':
                        statusClass = 'status-published';
                        statusText = 'Published';
                        break;
                    case 'draft':
                        statusClass = 'status-draft';
                        statusText = 'Draft';
                        break;
                    case 'scheduled':
                        statusClass = 'status-scheduled';
                        statusText = 'Scheduled';
                        break;
                }
                
                row.innerHTML = `
                    <td class="py-4 px-6 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="h-10 w-10 flex-shrink-0 bg-gray-200 rounded-lg flex items-center justify-center">
                                <i class="fas fa-file-alt text-gray-500"></i>
                            </div>
                            <div class="ml-4">
                                <div class="font-medium text-gray-900">${article.title}</div>
                            </div>
                        </div>
                    </td>
                    <td class="py-4 px-6 whitespace-nowrap">
                        <div class="text-sm">${formatDate(article.publishDate)}</div>
                    </td>
                    <td class="py-4 px-6 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">${article.category}</span>
                    </td>
                    <td class="py-4 px-6 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass} text-white">${statusText}</span>
                    </td>
                    <td class="py-4 px-6 whitespace-nowrap">
                        <a href="${article.previewLink}" class="text-blue-600 hover:text-blue-900">
                            <i class="fas fa-external-link-alt mr-1"></i> Preview
                        </a>
                    </td>
                    <td class="py-4 px-6 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 mr-3 edit-article" data-id="${article.id}">
                            <i class="fas fa-edit mr-1"></i> Edit
                        </button>
                        <button class="text-red-600 hover:text-red-900 delete-article" data-id="${article.id}">
                            <i class="fas fa-trash mr-1"></i> Delete
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Update pagination info
            document.getElementById('current-items').textContent = 1;
            document.getElementById('total-items').textContent = articlesToRender.length;
            document.getElementById('total-articles').textContent = articlesToRender.length;
            
            // Add event listeners to action buttons
            document.querySelectorAll('.edit-article').forEach(button => {
                button.addEventListener('click', () => {
                    const articleId = button.getAttribute('data-id');
                    alert(`Edit article with ID: ${articleId}`);
                });
            });
            
            document.querySelectorAll('.delete-article').forEach(button => {
                button.addEventListener('click', () => {
                    const articleId = button.getAttribute('data-id');
                    if (confirm('Are you sure you want to delete this article?')) {
                        alert(`Delete article with ID: ${articleId}`);
                    }
                });
            });
        }

        // Filter articles based on search and filters
        function filterArticles() {
            const searchText = document.getElementById('search-articles').value.toLowerCase();
            const statusFilter = document.getElementById('status-filter').value;
            const categoryFilter = document.getElementById('category-filter').value;
            
            const filteredArticles = articles.filter(article => {
                const matchesSearch = article.title.toLowerCase().includes(searchText);
                const matchesStatus = statusFilter === 'all' || article.status === statusFilter;
                const matchesCategory = categoryFilter === 'all' || article.category.toLowerCase() === categoryFilter;
                
                return matchesSearch && matchesStatus && matchesCategory;
            });
            
            // Sort by publish date (newest first)
            filteredArticles.sort((a, b) => new Date(b.publishDate) - new Date(a.publishDate));
            
            renderArticles(filteredArticles);
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            // Initial render
            renderArticles(articles);
            
            // Add event listeners for search and filters
            document.getElementById('search-articles').addEventListener('input', filterArticles);
            document.getElementById('status-filter').addEventListener('change', filterArticles);
            document.getElementById('category-filter').addEventListener('change', filterArticles);
            
            // Pagination buttons (for demonstration)
            document.getElementById('next-page').addEventListener('click', () => {
                alert('Next page clicked');
            });
            
            document.getElementById('prev-page').addEventListener('click', () => {
                alert('Previous page clicked');
            });
        });
    </script>
</AdminLayout>
